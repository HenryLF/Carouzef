import{useRef as _}from"react";import{Children as M,createContext as V,isValidElement as j,useCallback as D,useContext as F,useEffect as q,useMemo as G,useReducer as J}from"react";import{Children as g,isValidElement as Y,useRef as R,useEffect as $}from"react";function P(e,o,t,n){return n?(t+e+o)%t:Math.max(Math.min(o+e,t-1),0)}function y(e,o,t){return t?(e+o)%o:Math.min(o-1,Math.max(0,e))}function A(e,o,t,n){if(!n)return e-o;let r=e-o,u=r>0?r-t:r+t;return Math.abs(r)<Math.abs(u)?r:u}function z(e,o){let t={activeChilds:[],inactiveChilds:[]};return g.forEach(e,n=>{if(Y(n)){let{className:r}=n.props;r?.includes(o)?t.inactiveChilds.push(n):t.activeChilds.push(n)}}),t}function N(e,o){let t=g.count(e);if(!t)return[];let n=g.toArray(e),r=Math.max(o*2,3);for(;n.length<=r;)n=[...n,...n.slice(0,t)];return n}function k(e,o){return e===0?"active":e===-1?"prev":e===1?"next":Math.abs(e)>o/2+1?"hidden":e<0?"before":"after"}function B(e,o){let t=!1;return function(...n){let r=this;t||(e.apply(r,n),t=!0,setTimeout(()=>t=!1,o))}}function O({onSwipeLeft:e,onSwipeRight:o,onSwipeUp:t,onSwipeDown:n,onKeysUp:r,swipeThreshold:u,keyboardEventThrottle:p}){let l=R(null),c=R(null),f=u,a=s=>{for(let h in r)s.key==h&&r[h]()};return $(()=>{let s=B(a,p);return window.addEventListener("keyup",s),()=>window.removeEventListener("keyup",s)},[]),{onTouchStart:s=>{c.current=s.nativeEvent.targetTouches[0],l.current=s.nativeEvent.targetTouches[0]},onTouchMove:s=>c.current=s.nativeEvent.targetTouches[0],onTouchEnd:()=>{if(!l.current||!c.current)return;let s=c.current.clientX-l.current.clientX,h=c.current.clientY-l.current.clientY;s>f&&o(),s<-f&&e(),h>f&&n(),h<-f&&t()}}}import{jsx as v,jsxs as ne}from"react/jsx-runtime";var U=V(null);function Q(){return F(U)}var L=V(null);function Ce(){return F(L)}function Z(e,{type:o,arg:t}){let n;switch(o){case"increment_index":return n=P(e.index,t,e.numberOfItems,e.loop),{...e,index:n};case"set_index":return n=y(t,e.numberOfItems,e.loop),{...e,index:n};default:return e}}var ee={interval:3e3,step:1,stopOnHover:!0,reverse:!1};function ve({children:e,startingItem:o=0,itemsPerView:t=2,loop:n=!0,autoPlay:r,cssStyle:u,changeItemOnClick:p=!0,swipeThreshold:l=50,keyboardEventThrottle:c=500,keyboardNavigation:f={ArrowLeft:"previous",ArrowRight:"next"},axis:a="horizontal"}){let[x,T,S]=G(()=>{let{activeChilds:i,inactiveChilds:d}=z(e,"carousel-ignore");return[n?N(i,t):i,i,d]},[e,t,n]),s=M.count(x),h={index:y(o,s,n),itemsPerView:t,numberOfItems:s,realNumberOfItems:T.length,loop:n},C={...ee};if(r)switch(typeof r){case"number":C.interval=r;break;case"boolean":break;default:Object.assign(C,r)}let H={"--items-per-view":t,...u},K=D(i=>w({type:"set_index",arg:i}),[]),m=D(i=>w({type:"increment_index",arg:i}),[]),[X,w]=J(Z,h),I=_(!1),b=a=="vertical",E={};for(let i in f)f[i]=="next"?E[i]=()=>m(1):E[i]=()=>m(-1);let W=O({onSwipeLeft:b?()=>{}:()=>m(1),onSwipeRight:b?()=>{}:()=>m(-1),onSwipeUp:b?()=>m(1):()=>{},onSwipeDown:b?()=>m(-1):()=>{},onKeysUp:E,swipeThreshold:l,keyboardEventThrottle:c});return q(()=>{let i=[()=>{}];if(r&&C){let d=setInterval(()=>{C.step&&!I.current&&m(C.reverse?-1:1)},C.interval);i.push(()=>{clearInterval(d)})}return()=>i.forEach(d=>d())},[r]),v("div",{className:"carousel-wrapper",children:ne(U.Provider,{value:{setIndex:K,incrementIndex:m,...X},children:[v("div",{style:H,...W,onMouseEnter:()=>I.current=!0,onMouseLeave:()=>I.current=!1,className:"carousel-container",children:M.map(x,(i,d)=>v(te,{index:d,changeItemOnClick:p,axis:a,children:i},d))}),S]})})}function te({children:e,index:o,changeItemOnClick:t,axis:n}){let r=Q();if(!r)return e;let u=A(o,r.index,r.numberOfItems,r.loop),p={};n=="horizontal"?p.height="auto":p.width="auto";let l={"--item-index":`${o}`,"--distance-to-active":`${u}`,...p};if(j(e)){let a=e.props.cssStyle;a&&Object.assign(l,a)}let c=k(u,r.itemsPerView);return v("div",{onClickCapture:t?a=>{o!=r?.index&&(a.stopPropagation(),a.preventDefault(),r.setIndex(o))}:()=>{},className:`carousel-item carousel-item-${c}`,style:l,children:v(L.Provider,{value:{index:o,activeIndex:r?.index,toActiveIndex:u,position:c},children:e})})}export{ve as Carouzef,Q as useCarouzef,Ce as useCarouzefItem};
