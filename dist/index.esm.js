import{Children as O,createContext as D,isValidElement as B,useCallback as M,useContext as V,useEffect as _,useMemo as j,useReducer as q}from"react";import{Children as E,isValidElement as W,useRef as w,useEffect as Y}from"react";function R(e,o,t,r){return r?(t+e+o)%t:Math.max(Math.min(o+e,t-1),0)}function g(e,o,t){return t?(e+o)%o:Math.min(o-1,Math.max(0,e))}function P(e,o,t,r){if(!r)return e-o;let n=e-o,u=n>0?n-t:n+t;return Math.abs(n)<Math.abs(u)?n:u}function A(e,o){let t={activeChilds:[],inactiveChilds:[]};return E.forEach(e,r=>{if(W(r)){let{className:n}=r.props;n?.includes(o)?t.inactiveChilds.push(r):t.activeChilds.push(r)}}),t}function z(e,o){let t=E.count(e);if(!t)return[];let r=E.toArray(e),n=Math.max(o*2,3);for(;r.length<=n;)r=[...r,...r.slice(0,t)];return r}function N(e,o){return e===0?"active":e===-1?"prev":e===1?"next":Math.abs(e)>o/2+1?"hidden":e<0?"before":"after"}function $(e,o){let t=!1;return function(...r){let n=this;t||(e.apply(n,r),t=!0,setTimeout(()=>t=!1,o))}}function k({onSwipeLeft:e,onSwipeRight:o,onSwipeUp:t,onSwipeDown:r,onKeysUp:n,swipeThreshold:u,keyboardEventThrottle:p}){let l=w(null),c=w(null),m=u,a=i=>{for(let h in n)i.key==h&&n[h]()};return Y(()=>{let i=$(a,p);return window.addEventListener("keyup",i),()=>window.removeEventListener("keyup",i)},[]),{onTouchStart:i=>{c.current=i.nativeEvent.targetTouches[0],l.current=i.nativeEvent.targetTouches[0]},onTouchMove:i=>c.current=i.nativeEvent.targetTouches[0],onTouchEnd:()=>{if(!l.current||!c.current)return;let i=c.current.clientX-l.current.clientX,h=c.current.clientY-l.current.clientY;i>m&&o(),i<-m&&e(),h>m&&r(),h<-m&&t()}}}import{jsx as b,jsxs as ee}from"react/jsx-runtime";var F=D(null);function G(){return V(F)}var U=D(null);function fe(){return V(U)}function J(e,{type:o,arg:t}){let r;switch(o){case"increment_index":return r=R(e.index,t,e.numberOfItems,e.loop),{...e,index:r};case"set_index":return r=g(t,e.numberOfItems,e.loop),{...e,index:r};default:return e}}var Q={interval:3e3,step:1};function de({children:e,startingItem:o=0,itemsPerView:t=2,loop:r=!0,autoPlay:n,cssStyle:u,changeItemOnClick:p=!0,swipeThreshold:l=50,keyboardEventThrottle:c=500,keyboardNavigation:m={ArrowLeft:"previous",ArrowRight:"next"},axis:a="horizontal"}){let[x,y,T]=j(()=>{let{activeChilds:s,inactiveChilds:d}=A(e,"carousel-ignore");return[z(s,t),s,d]},[e,t]),i=O.count(x),h={index:g(o,i,r),itemsPerView:t,numberOfItems:i,realNumberOfItems:y.length,loop:r},C={...Q};if(n)switch(typeof n){case"number":C.interval=n;break;case"boolean":break;default:Object.assign(C,n)}let K={"--items-per-view":t,...u},L=M(s=>S({type:"set_index",arg:s}),[]),f=M(s=>S({type:"increment_index",arg:s}),[]),[X,S]=q(J,h),v=a=="vertical",I={};for(let s in m)m[s]=="next"?I[s]=()=>f(1):I[s]=()=>f(-1);let H=k({onSwipeLeft:v?()=>{}:()=>f(1),onSwipeRight:v?()=>{}:()=>f(-1),onSwipeUp:v?()=>f(1):()=>{},onSwipeDown:v?()=>f(-1):()=>{},onKeysUp:I,swipeThreshold:l,keyboardEventThrottle:c});return _(()=>{let s=[()=>{}];if(n&&C){let d=setInterval(()=>f(1),C.interval);s.push(()=>{clearInterval(d)})}return()=>s.forEach(d=>d())},[n]),b("div",{style:K,...H,className:"carousel-container",children:ee(F.Provider,{value:{setIndex:L,incrementIndex:f,...X},children:[O.map(x,(s,d)=>b(Z,{index:d,changeItemOnClick:p,axis:a,children:s},d)),T]})})}function Z({children:e,index:o,changeItemOnClick:t,axis:r}){let n=G();if(!n)return e;let u=P(o,n.index,n.numberOfItems,n.loop),p={};r=="horizontal"?p.height="auto":p.width="auto";let l={"--item-index":`${o}`,"--distance-to-active":`${u}`,...p};if(B(e)){let a=e.props.cssStyle;a&&Object.assign(l,a)}let c=N(u,n.itemsPerView);return b("div",{onClickCapture:t?a=>{o!=n?.index&&(a.stopPropagation(),a.preventDefault(),n.setIndex(o))}:()=>{},className:`carousel-item carousel-item-${c}`,style:l,children:b(U.Provider,{value:{index:o,activeIndex:n?.index,toActiveIndex:u,position:c},children:e})})}export{de as Carouzef,G as useCarouzef,fe as useCarouzefItem};
